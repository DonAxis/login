<!DOCTYPE html>
<html lang="es">
<head>
 <meta charset="UTF-8">
 <meta name="viewport" content="width=device-width, initial-scale=1.0">
 <link rel="stylesheet" href="botones.css">
 <link rel="stylesheet" href="Personas.css">
 <title>Panel de Coordinador</title>
 <style>
 .header {
 background: linear-gradient(135deg, #43a047 0%, #2e7d32 100%);
 color: white;
 padding: 20px;
 border-radius: 10px;
 margin-bottom: 30px;
 display: flex;
 justify-content: space-between;
 align-items: center;
 }

 .header h1 {
 color: white;
 margin: 0;
 }

 .user-info {
 text-align: right;
 }

 .user-info p {
 margin: 5px 0;
 font-size: 0.9rem;
 }

 .btn-logout {
 background: rgba(255, 255, 255, 0.2);
 color: white;
 border: 2px solid white;
 padding: 8px 20px;
 border-radius: 8px;
 cursor: pointer;
 font-weight: 600;
 margin-top: 10px;
 transition: all 0.3s;
 }

 .btn-logout:hover {
 background: white;
 color: #43a047;
 }

 .menu-principal {
 display: grid;
 grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
 gap: 20px;
 margin-bottom: 30px;
 }

 .menu-card {
 background: white;
 padding: 25px;
 border-radius: 12px;
 box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
 text-align: center;
 cursor: pointer;
 transition: all 0.3s;
 border: 3px solid transparent;
 }

 .menu-card:hover {
 transform: translateY(-5px);
 box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
 border-color: #43a047;
 }

 .menu-card.active {
 border-color: #43a047;
 background: #f1f8e9;
 }

 .menu-card h3 {
 color: #43a047;
 margin-bottom: 10px;
 font-size: 1.3rem;
 }

 .menu-card p {
 color: #666;
 font-size: 0.9rem;
 }

 .seccion-contenido {
 display: none;
 background: white;
 padding: 25px;
 border-radius: 12px;
 box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
 }

 .seccion-contenido.active {
 display: block;
 animation: fadeIn 0.3s;
 }

 @keyframes fadeIn {
 from { opacity: 0; transform: translateY(10px); }
 to { opacity: 1; transform: translateY(0); }
 }

 .seccion-header {
 display: flex;
 justify-content: space-between;
 align-items: center;
 margin-bottom: 20px;
 padding-bottom: 15px;
 border-bottom: 2px solid #43a047;
 }

 .seccion-header h2 {
 color: #43a047;
 margin: 0;
 }

 .btn-volver {
 background: #e0e0e0;
 color: #333;
 padding: 8px 16px;
 border: none;
 border-radius: 6px;
 cursor: pointer;
 font-weight: 600;
 transition: all 0.2s;
 }

 .btn-volver:hover {
 background: #d0d0d0;
 }

 .lista-items {
 margin-top: 20px;
 }

 .item {
 background: #f5f5f5;
 padding: 15px;
 border-radius: 8px;
 margin-bottom: 10px;
 display: flex;
 justify-content: space-between;
 align-items: center;
 transition: all 0.2s;
 }

 .item:hover {
 background: #e8f5e9;
 transform: translateX(5px);
 }

 .item-info h4 {
 margin: 0 0 5px 0;
 color: #333;
 }

 .item-info p {
 margin: 0;
 color: #666;
 font-size: 0.9rem;
 }

 .item-acciones button {
 margin-left: 5px;
 }

 .sin-datos {
 text-align: center;
 padding: 40px;
 color: #999;
 }
 </style>
</head>
<body>

 <!-- TABS DE MODO - REDISEÑADOS -->
 <div style="background: #2c3e50; padding: 0; box-shadow: 0 2px 10px rgba(0,0,0,0.2); margin-bottom: 0;">
 <div style="max-width: 1200px; margin: 0 auto; display: flex;">
 <button id="tabCoordinador" onclick="cambiarModo('coordinador')" 
 style="flex: 1; padding: 15px 30px; background: transparent; color: white; border: none; border-bottom: 4px solid white; cursor: pointer; font-size: 1.05rem; font-weight: 600; transition: all 0.3s; position: relative;"> Modo Coordinador
 </button>
 <button id="tabProfesor" onclick="cambiarModo('profesor')" 
 style="flex: 1; padding: 15px 30px; background: transparent; color: rgba(255,255,255,0.6); border: none; border-bottom: 4px solid transparent; cursor: pointer; font-size: 1.05rem; font-weight: 600; transition: all 0.3s; position: relative;">Modo Profesor
 </button>
 </div>
 </div>

 <!-- HEADER MAS COMPACTO -->
 <div id="headerCoordinador" style="background: linear-gradient(135deg, #888 0%, #666 100%); color: white; padding: 15px 20px; margin-bottom: 20px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 8px rgba(0,0,0,0.15); opacity: 0; transition: all 0.5s ease;">
 
 <!-- Lado izquierdo: Titulo y selector de carrera -->
 <div style="flex: 1;">
 <h1 style="margin: 0 0 5px 0; font-size: 1.8rem; color: white;">Panel de Coordinador</h1>
 <div id="carreraInfo" style="margin-bottom: 10px;">
 <span style="font-size: 1.5rem; font-weight: 800; text-shadow: 2px 2px 6px rgba(0,0,0,0.25);">
 Cargando...
 </span>
 </div>
 
 <div style="display: flex; align-items: center; gap: 15px; flex-wrap: wrap;">
 <div id="selectorCarreras" style="display: none; align-items: center; gap: 10px;">
 <label style="font-weight: 600; color: white; font-size: 0.95rem;">Cambiar carrera:</label>
 <select id="selectCarrera" onchange="cambiarCarreraActiva()" 
 style="padding: 6px 12px; border: 2px solid white; border-radius: 6px; font-size: 0.95rem; font-weight: 600; background: white; color: #333; cursor: pointer; min-width: 200px;">
 <option value="">Cargando...</option>
 </select>
 </div>
 
 <div>
 <span style="background: rgba(255,255,255,0.2); padding: 6px 12px; border-radius: 6px; font-size: 0.9rem; display: inline-block;">
 <strong>Carreras asignadas:</strong> <span id="cantidadCarreras">0</span>
 </span>
 </div>
 </div>
 </div>
 
 <!-- Lado derecho: Info del usuario -->
 <div style="text-align: right;">
 <p style="margin: 3px 0; font-size: 0.9rem;"><strong>Nombre:</strong> <span id="nombreUsuario">Cargando...</span></p>
 <p style="margin: 3px 0; font-size: 0.9rem;"><strong>Email:</strong> <span id="emailUsuario">Cargando...</span></p>
 <p style="margin: 3px 0; font-size: 0.9rem;"><strong>Carrera:</strong> <span id="carreraUsuario">Cargando...</span></p>
 <p style="background: linear-gradient(135deg, #216A32 0%, #21596A 100%); color: white; padding: 5px 12px; border-radius: 6px; font-weight: 600; margin: 8px 0 8px auto; display: inline-block; font-size: 0.9rem;">
 <strong>Periodo:</strong> <span id="periodoUsuario">Cargando...</span>
 </p>
 <button onclick="cerrarSesion()" class="btn-logout" style="margin-top: 5px; padding: 6px 16px; font-size: 0.9rem;">Cerrar Sesion</button>
 </div>
 </div>

 <!-- CONTENEDOR MODO COORDINADOR -->
 <div id="modoCoordinador" style="display: block;">
 
 <!-- MENU PRINCIPAL -->
 <div id="menuPrincipal" class="menu-principal">
 <div class="menu-card" id="menuCarreras" onclick="mostrarSeccion('carreras')" style="display: none;">
 <h3>Carreras</h3>
 <p>Gestionar carreras y programas</p>
 </div>

 <div class="menu-card" onclick="mostrarSeccion('grupos')">
 <h3>Grupos</h3>
 <p>Gestionar grupos academicos</p>
 </div>

 <div class="menu-card" onclick="mostrarSeccion('materias')">
 <h3>Materias</h3>
 <p>Crear y administrar materias</p>
 </div>

 <div class="menu-card" onclick="mostrarSeccion('profesores')">
 <h3>Gestionar Profesores</h3>
 <p>Crear y administrar profesores</p>
 </div>

 <div class="menu-card" onclick="mostrarSeccion('alumnos')">
 <h3>Gestionar Alumnos</h3>
 <p>Crear y administrar alumnos</p>
 </div>

 <div class="menu-card" onclick="mostrarSeccion('asignaciones')">
 <h3>Armar Grupos</h3>
 <p>Asignar profesores a materias</p>
 </div>

 <div class="menu-card" onclick="mostrarSeccion('inscripciones')">
 <h3>Inscripciones Especiales</h3>
 <p>Inscripciones fuera del grupo regular</p>
 </div>

 <div class="menu-card" onclick="mostrarSeccion('calificaciones')">
 <h3>Calificaciones</h3>
 <p>Ver y editar calificaciones</p>
 </div>

 <div class="menu-card" onclick="mostrarSeccion('periodos')">
 <h3>Periodos</h3>
 <p>Gestionar periodos academicos</p>
 </div>
 </div>

 <!-- SECCION: CARRERAS -->
 <div id="seccionCarreras" class="seccion-contenido">
 <div class="seccion-header">
 <h2>Gestion de Carreras</h2>
 <button onclick="volverMenu()" class="btn-volver">← Volver al Menu</button>
 </div>
 <div class="botones-accion">
 <button onclick="mostrarFormCarrera()" class="botAzu">Nueva Carrera</button>
 </div>
 <div id="listaCarreras" class="lista-items"></div>
 </div>

 <!-- SECCION: MATERIAS -->
 <div id="seccionMaterias" class="seccion-contenido">
 <div class="seccion-header">
 <h2>Gestion de Materias</h2>
 <button onclick="volverMenu()" class="btn-volver">← Volver al Menu</button>
 </div>
 <div class="botones-accion">
 <button onclick="mostrarFormMateria()" class="botAzu">Nueva Materia</button>
 </div>
 <div id="listaMaterias" class="lista-items"></div>
 </div>

 <!-- SECCION: GRUPOS -->
 <div id="seccionGrupos" class="seccion-contenido">
 <div class="seccion-header">
 <h2>Gestion de Grupos</h2>
 <button onclick="volverMenu()" class="btn-volver">← Volver al Menu</button>
 </div>
 <div class="botones-accion">
 <button onclick="mostrarGenerarGrupos()" class="botAzu">Generar Grupos</button>
 </div>
 <div id="listaGrupos" class="lista-items"></div>
 </div>

 <!-- SECCION: GESTIONAR PROFESORES -->
 <div id="seccionProfesores" class="seccion-contenido">
 <div class="seccion-header">
 <h2>Gestion de Profesores</h2>
 <button onclick="volverMenu()" class="btn-volver">← Volver al Menu</button>
 </div>
 <div class="botones-accion">
 <button onclick="mostrarFormProfesor()" class="botAzu">Nuevo Profesor</button>
 </div>
 <div id="listaProfesores" class="lista-items"></div>
 </div>

 <!-- SECCION: GESTIONAR ALUMNOS -->
 <div id="seccionAlumnos" class="seccion-contenido">
 <div class="seccion-header">
 <h2>Registro de Alumnos</h2>
 <button onclick="volverMenu()" class="btn-volver">← Volver al Menu</button>
 </div>
 <div class="botones-accion">
 <button onclick="mostrarFormAlumno()" class="botAzu">Nuevo Alumno</button>

 <button onclick="mostrarHistorialAlumnos()" class="botAzu" style="background: linear-gradient(135deg, #56ab2f 0%, #a8e063 100%);">
 Ver Historial
 </button>
 <!-- MODAL PARA REGISTRO MASIVO DE ALUMNOS -->
<!-- Este código se debe integrar en controlCoordinador.html -->

<!-- AGREGAR AL HTML, después de la línea 343 (después del botón "Ver Historial") -->

<button onclick="mostrarFormRegistroMasivo()" class="botAzu" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
  Multiples Alumnos
</button>

<!-- MODAL PARA REGISTRO MASIVO (agregar después del modalGenerico existente) -->
<div id="modalRegistroMasivo" class="modal" style="display: none;">
  <div class="modal-contenido" style="max-width: 900px;">
    <span class="cerrar" onclick="cerrarModalMasivo()">&times;</span>
    
    <h2 style="color: #667eea; margin-bottom: 10px;">Registro Masivo de Alumnos</h2>
    <p style="color: #666; margin-bottom: 20px;">Copia y pega desde Excel los datos de los alumnos</p>
    
    <form id="formRegistroMasivo" onsubmit="procesarRegistroMasivo(event)">
      
      <!-- SELECTOR DE GRUPO -->
      <div class="form-grupo" style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
        <label for="grupoMasivo" style="font-weight: 600; font-size: 1.1rem; color: #333; display: block; margin-bottom: 10px;">
          Grupo al que pertenecen: *
        </label>
        <select id="grupoMasivo" required 
                style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 1rem; background: white;">
          <option value="">Seleccionar grupo...</option>
        </select>
        <small style="color: #666; display: block; margin-top: 8px;">
          Todos los alumnos seran asignados a este grupo
        </small>
      </div>

      <!-- INSTRUCCIONES -->
       <div style="background: #e3f2fd; border-left: 4px solid #2196f3; padding: 15px; border-radius: 4px; margin-bottom: 20px;">
        <strong style="color: #1565c0;">Instrucciones:</strong>
        <p style="margin: 10px 0 0 0; color: #333;">
          Abajo observarás 3 columnas: <strong>Nombre completo</strong>, <strong>Matrícula</strong> y <strong>Correo</strong>.
          Coloca los datos en ese orden y con coherencia.
        </p>
        <p style="margin: 8px 0 0 0; color: #333;">
          Antes de darle a <strong>“Guardar todos”</strong>, revisa los datos en la sección de <strong>“Vista previa”</strong> para asegurarte de que sean correctos.
        </p>
        <p style="margin: 8px 0 0 0; color: #333;">
          Se agregó un <strong>ejemplo</strong> para que puedas ver cómo llenar los datos correctamente.
        </p>
      </div>


      <!-- EJEMPLO VISUAL -->
      <div style="background: #f5f5f5; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
        <strong style="display: block; margin-bottom: 10px;">Ejemplo de formato esperado:</strong>
        <table style="width: 100%; border-collapse: collapse; font-size: 0.9rem;">
          <thead>
            <tr style="background: #667eea; color: white;">
              <th style="padding: 8px; border: 1px solid #ddd;">Nombre</th>
              <th style="padding: 8px; border: 1px solid #ddd;">Matricula</th>
              <th style="padding: 8px; border: 1px solid #ddd;">Email</th>
            </tr>
          </thead>
          <tbody>
            <tr style="background: white;">
              <td style="padding: 8px; border: 1px solid #ddd;">Ana Sofia Martinez Lopez</td>
              <td style="padding: 8px; border: 1px solid #ddd;">A20231045</td>
              <td style="padding: 8px; border: 1px solid #ddd;">ana.martinez@ejemplo.edu</td>
            </tr>
            <tr style="background: #f9f9f9;">
              <td style="padding: 8px; border: 1px solid #ddd;">Luis Fernando Gomez Ruiz</td>
              <td style="padding: 8px; border: 1px solid #ddd;">A20231046</td>
              <td style="padding: 8px; border: 1px solid #ddd;">luis.gomez@ejemplo.edu</td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- CAMPOS PARA PEGAR DATOS -->
      <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px; margin-bottom: 20px;">
        
        <!-- NOMBRES -->
        <div>
          <label style="font-weight: 600; display: block; margin-bottom: 8px; color: #333;">
            Nombres Completos *
          </label>
          <textarea id="nombresMasivo" required rows="12" 
                    placeholder="Ana Sofia Martinez Lopez&#10;Luis Fernando Gomez Ruiz&#10;..."
                    style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 8px; font-family: monospace; font-size: 0.9rem; resize: vertical;"></textarea>
        </div>

        <!-- MATRICULAS -->
        <div>
          <label style="font-weight: 600; display: block; margin-bottom: 8px; color: #333;">
            Matriculas *
          </label>
          <textarea id="matriculasMasivo" required rows="12" 
                    placeholder="A20231045&#10;A20231046&#10;..."
                    style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 8px; font-family: monospace; font-size: 0.9rem; resize: vertical;"></textarea>
        </div>

        <!-- EMAILS -->
        <div>
          <label style="font-weight: 600; display: block; margin-bottom: 8px; color: #333;">
            Correos Electronicos *
          </label>
          <textarea id="emailsMasivo" required rows="12" 
                    placeholder="ana.martinez@ejemplo.edu&#10;luis.gomez@ejemplo.edu&#10;..."
                    style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 8px; font-family: monospace; font-size: 0.9rem; resize: vertical;"></textarea>
        </div>

      </div>

      <!-- AREA DE VISTA PREVIA -->
      <div id="vistaPrevia" style="display: none; background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 20px; max-height: 300px; overflow-y: auto;">
        <h3 style="margin-top: 0; color: #333;">Vista Previa:</h3> Revisa que esté correcto
        <div id="contenidoVistaPrevia"></div>
      </div>

      <!-- BOTONES DE ACCION -->
      <div class="form-botones" style="display: flex; gap: 10px; justify-content: flex-end;">
        <button type="button" onclick="previsualizarDatos()" class="botAzu" 
                style="background: linear-gradient(135deg, #4caf50 0%, #2e7d32 100%);">
          Vista Previa
        </button>
        <button type="submit" class="botAzu" 
                style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
          Guardar Todos
        </button>
        <button type="button" onclick="cerrarModalMasivo()" class="botAzu" 
                style="background: #e0e0e0; color: #333;">
          Cancelar
        </button>
      </div>

    </form>

    <!-- BARRA DE PROGRESO -->
    <div id="barraProgreso" style="display: none; margin-top: 20px;">
      <div style="background: #e0e0e0; border-radius: 10px; height: 30px; overflow: hidden;">
        <div id="barraProgresoFill" 
             style="height: 100%; background: linear-gradient(90deg, #667eea 0%, #764ba2 100%); width: 0%; transition: width 0.3s; display: flex; align-items: center; justify-content: center; color: white; font-weight: 600; font-size: 0.9rem;">
          0%
        </div>
      </div>
      <p id="textoProgreso" style="text-align: center; margin-top: 10px; color: #666;">
        Procesando...
      </p>
    </div>

  </div>
</div>

<style>
/* Estilos adicionales para el modal masivo */
#modalRegistroMasivo .modal-contenido {
  max-height: 90vh;
  overflow-y: auto;
}

#modalRegistroMasivo textarea {
  font-family: 'Courier New', monospace;
  line-height: 1.5;
}

#modalRegistroMasivo textarea:focus {
  outline: none;
  border-color: #667eea;
  box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
}

.mensaje-exito-masivo {
  background: #d4edda;
  border: 2px solid #28a745;
  color: #155724;
  padding: 15px;
  border-radius: 8px;
  margin-bottom: 15px;
  font-weight: 600;
}

.mensaje-error-masivo {
  background: #f8d7da;
  border: 2px solid #dc3545;
  color: #721c24;
  padding: 15px;
  border-radius: 8px;
  margin-bottom: 15px;
  font-weight: 600;
}

.tabla-preview {
  width: 100%;
  border-collapse: collapse;
  font-size: 0.85rem;
}

.tabla-preview th {
  background: #667eea;
  color: white;
  padding: 8px;
  text-align: left;
  border: 1px solid #ddd;
}

.tabla-preview td {
  padding: 8px;
  border: 1px solid #ddd;
  background: white;
}

.tabla-preview tr:nth-child(even) td {
  background: #f9f9f9;
}

.error-row {
  background: #ffebee !important;
  color: #c62828;
}
</style>
 </div>
 
 <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 15px; display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
 <div>
 <label style="font-weight: 600; display: block; margin-bottom: 5px;">Filtrar por estado:</label>
 <select id="filtroEstadoAlumnos" onchange="cargarAlumnos()" style="width: 100%; padding: 8px 12px; border: 2px solid #ddd; border-radius: 5px;">
 <option value="todos">Todos</option>
 <option value="activos">Solo estudiando</option>
 <option value="inactivos">Solo suspendidos</option>
 </select>
 </div>
 
 <div>
 <label style="font-weight: 600; display: block; margin-bottom: 5px;">Filtrar por grupo:</label>
 <select id="filtroGrupoAlumnos" onchange="cargarAlumnos()" style="width: 100%; padding: 8px 12px; border: 2px solid #ddd; border-radius: 5px;">
 <option value="todos">Todos los grupos</option>
 </select>
 </div>
 </div>
 
 <div id="listaAlumnos" class="lista-items"></div>
 </div>

 <!-- SECCION: ASIGNAR PROFESORES -->
 <div id="seccionAsignaciones" class="seccion-contenido">
 <div class="seccion-header">
 <h2>Armar Grupos (Materia + Profesor + Grupo)</h2>
 <button onclick="volverMenu()" class="btn-volver">← Volver al Menu</button>
 </div>
 <div class="botones-accion">
 <button onclick="mostrarFormAsignarProfesor()" class="botAzu">Nueva Asignacion</button>
 </div>
 <div id="listaAsignaciones" class="lista-items"></div>
 </div>

 <!-- SECCION: INSCRIBIR ALUMNOS -->

  <!-- SECCION: INSCRIPCIONES ESPECIALES -->
  <div id="seccionInscripciones" class="seccion-contenido">
  <div class="seccion-header">
    <h2>Inscripciones Especiales</h2>
    <button onclick="volverMenu()" class="btn-volver">Volver al Menu</button>
  </div>
  
  <!-- Informacion explicativa -->
  <div style="background: #fff3cd; padding: 20px; border-radius: 10px; margin-bottom: 20px; border-left: 4px solid #ffc107;">
      <h3 style="margin: 0 0 10px 0; color: #856404;">
        Alumnos que NO pertenecen a un grupo y tomaran materias de multiples grupos
      </h3>
  </div>
    
    <!-- Botones de accion -->
    <div class="botones-accion" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 25px;">
      <button onclick="mostrarFormCrearAlumnoEspecial()" 
              style="padding: 15px 20px; background: linear-gradient(135deg, #43a047 0%, #2e7d32 100%); color: white; border: none; border-radius: 10px; font-weight: 700; cursor: pointer; font-size: 1rem; box-shadow: 0 4px 12px rgba(67, 160, 71, 0.3);">
        + Crear Alumno Especial
      </button>
      
      <button onclick="mostrarFormInscribirAlumno()" 
              style="padding: 15px 20px; background: linear-gradient(135deg, #2196f3 0%, #1976d2 100%); color: white; border: none; border-radius: 10px; font-weight: 700; cursor: pointer; font-size: 1rem; box-shadow: 0 4px 12px rgba(33, 150, 243, 0.3);">
        Inscribir en Materia
      </button>
    </div>
    
    <!-- Lista de inscripciones -->
    <div id="listaInscripciones" class="lista-items">
      <div class="sin-datos">
        <p>Cargando inscripciones especiales...</p>
      </div>
    </div>
  </div>


 <!-- SECCION: CALIFICACIONES -->
 <div id="seccionCalificaciones" class="seccion-contenido">
 <div class="seccion-header">
 <h2>Gestionar Calificaciones</h2>
 <button onclick="volverMenu()" class="btn-volver">← Volver al Menu</button>
 </div>

 <div style="background: white; padding: 20px; border-radius: 10px; margin-bottom: 20px;">
 <h3 style="margin-top: 0;">Seleccionar Materia</h3>
 <div style="display: grid; gap: 15px;">
 <div>
 <label style="display: block; margin-bottom: 5px; font-weight: 600;">Materia:</label>
 <select id="selectMateriaCalif" onchange="cargarCalificacionesMateria()" 
 style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 5px;">
 <option value="">Seleccionar materia...</option>
 </select>
 <small style="color: #666; display: block; margin-top: 5px;">
 Selecciona una materia y grupo para ver y editar calificaciones
 </small>
 </div>
 </div>
 </div>

 <div id="contenedorCalificaciones" style="display: none;">
 <div style="background: white; padding: 20px; border-radius: 10px;">
 <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
 <div>
 <h3 style="margin: 0;" id="tituloMateriaCalif">Materia</h3>
 <p style="margin: 5px 0; color: #666;" id="infoMateriaCalif">Informacion de la materia</p>
 </div>
 <div style="display: flex; gap: 10px;">
 <button onclick="guardarTodasCalificacionesCoord()" 
 style="padding: 12px 24px; background: linear-gradient(135deg, #216A32 0%, #21596A 100%); color: white; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; font-size: 1rem;">
 Guardar Calificaciones
 </button>
 <button onclick="descargarActaPDF()" 
 style="padding: 12px 24px; background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; font-size: 1rem;">
 Descargar PDF
 </button>
 </div>
 </div>
 <div id="tablaCalificacionesCoord"></div>
 </div>
 </div>
 </div>

 <!-- SECCION: PERIODOS -->
<div id="seccionPeriodos" class="seccion-contenido">
  <div class="seccion-header">
    <h2>Periodos Academicos</h2>
    <button onclick="volverMenu()" class="btn-volver">← Volver al Menu</button>
  </div>

  <div style="background: white; padding: 20px; border-radius: 10px; margin-bottom: 20px;">
    <h3 style="margin-top: 0;">Informacion del Periodo Actual</h3>
    <div id="infoPeriodoActual" style="padding: 15px; background: #f8f9fa; border-radius: 8px;">
      <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
        <div>
          <div style="font-size: 0.85rem; color: #666; margin-bottom: 5px;">Periodo:</div>
          <div style="font-size: 1.8rem; font-weight: bold; color: #216A32;" id="periodoActualDisplay">2026-1</div>
        </div>
        <div>
          <div style="font-size: 0.85rem; color: #666; margin-bottom: 5px;">Alumnos Activos:</div>
          <div style="font-size: 1.8rem; font-weight: bold; color: #1976d2;" id="alumnosActivosDisplay">0</div>
        </div>
        <div>
          <div style="font-size: 0.85rem; color: #666; margin-bottom: 5px;">Grupos Activos:</div>
          <div style="font-size: 1.8rem; font-weight: bold; color: #f57c00;" id="gruposActivosDisplay">0</div>
        </div>
        <div>
          <div style="font-size: 0.85rem; color: #666; margin-bottom: 5px;">Asignaciones Activas:</div>
          <div style="font-size: 1.8rem; font-weight: bold; color: #7b1fa2;" id="asignacionesActivasDisplay">0</div>
        </div>
      </div>
    </div>
  </div>

  <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; margin-bottom: 20px;">
    <div style="background: white; padding: 20px; border-radius: 10px; border: 2px solid #667eea;">
      <h3 style="margin-top: 0; color: #667eea;">Cambiar Periodo</h3>
      <p style="color: #666; margin-bottom: 15px; font-size: 0.9rem;">Avanza tu carrera al siguiente periodo academico</p>
      <button onclick="mostrarCambioPeriodo(usuarioActual.carreraId, periodoActualCarrera)" 
        style="width: 100%; padding: 12px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; border-radius: 8px; font-weight: 600; cursor: pointer;">
        Cambiar Periodo
      </button>
    </div>

    <div style="background: white; padding: 20px; border-radius: 10px; border: 2px solid #4caf50;">
      <h3 style="margin-top: 0; color: #4caf50;">Historial de Grupos</h3>
      <p style="color: #666; margin-bottom: 15px; font-size: 0.9rem;">Ver grupos archivados de periodos anteriores</p>
      <button onclick="verHistorialGrupos(usuarioActual.carreraId)" 
        style="width: 100%; padding: 12px; background: linear-gradient(135deg, #4caf50 0%, #2e7d32 100%); color: white; border: none; border-radius: 8px; font-weight: 600; cursor: pointer;">
        Ver Historial
      </button>
    </div>
  </div>

  <div style="background: white; padding: 20px; border-radius: 10px;">
    <h3 style="margin-top: 0;">Informacion Importante</h3>
    <div style="background: #e8f5e9; border-left: 4px solid #4caf50; padding: 15px; border-radius: 4px; margin-bottom: 15px;">
      <strong>Que sucede al cambiar periodo:</strong>
      <ul style="margin: 10px 0; padding-left: 20px;">
        <li>Los alumnos avanzan al siguiente semestre (Ej: 1101-MAT a 1201-MAT)</li>
        <li>Los alumnos de ultimo semestre pasan a GRADUADOS</li>
        <li>Los grupos actuales se archivan en el historial</li>
        <li>Las asignaciones de profesores se desactivan</li>
        <li>Las calificaciones se guardan en el historial</li>
      </ul>
    </div>
    
    <div style="background: #fff3cd; border-left: 4px solid #ffc107; padding: 15px; border-radius: 4px; margin-bottom: 15px;">
      <strong>Importante:</strong>
      <p style="margin: 5px 0 0 0;">Esta accion solo afecta a tu carrera. Pero tus profesores y alumnos se veran afectados.</p>
    </div>
    
    <div style="background: #f8d7da; border-left: 4px solid #dc3545; padding: 15px; border-radius: 4px;">
      <strong>Advertencia:</strong>
      <p style="margin: 5px 0 0 0;">El cambio de periodo NO se puede deshacer. Asegurate de que todo este correcto antes de continuar.</p>
    </div>
  </div>
</div>

 <!-- MODAL GENERICO -->
 <div id="modalGenerico" class="modal">
 <div class="modal-contenido">
 <span class="cerrar" onclick="cerrarModal()">&times;</span>
 <h2 id="tituloModal">Formulario</h2>
 <div id="contenidoModal"></div>
 </div>
 </div>

 </div>
 <!-- FIN MODO COORDINADOR -->

 <!-- CONTENEDOR MODO PROFESOR -->
 <div id="modoProfesor" style="display: none;">
 <iframe id="iframeProfesor" src="" style="width: 100%; height: calc(100vh - 60px); border: none;"></iframe>
 </div>
 <!-- FIN MODO PROFESOR -->

 <!-- Firebase SDK -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.31/jspdf.plugin.autotable.min.js"></script>

  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>

  <script src="firebase.js"></script>


  <script src="logoPdf.js"></script>
  <script src="HistorialCoorPDF.js"></script>
  <script src="HistorialAlumnoPDF.js"></script>
  <script src="coordinador.js"></script>   
  <script src="inscripcionEspecial.js"></script>
  <script src="calificacionEspecial.js"></script>
  <script src="cambioPeriodo.js"></script>
  <script src="registroMasivoAlumno.js"></script>


 <script>
 window.addEventListener('load', () => {
 if (typeof window.jspdf !== 'undefined') {
 console.log('jsPDF cargado correctamente');
 } else {
 console.error('ERROR: jsPDF no se cargo');
 }
 });
 </script>

</body>
</html>