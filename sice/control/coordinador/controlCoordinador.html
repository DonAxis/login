<!DOCTYPE html>
<html lang="es">
<head>
 <meta charset="UTF-8">
 <meta name="viewport" content="width=device-width, initial-scale=1.0">
 <link rel="stylesheet" href="../../css/common/botones.css">
 <link rel="stylesheet" href="../../css/common/Personas.css">
 <title>Panel de Coordinador</title>
 <style>
 .header {
 background: linear-gradient(135deg, #43a047 0%, #2e7d32 100%);
 color: white;
 padding: 20px;
 border-radius: 10px;
 margin-bottom: 30px;
 display: flex;
 justify-content: space-between;
 align-items: center;
 }

 .header h1 {
 color: white;
 margin: 0;
 }

 .user-info {
 text-align: right;
 }

 .user-info p {
 margin: 5px 0;
 font-size: 0.9rem;
 }

 .btn-logout {
 background: rgba(255, 255, 255, 0.2);
 color: white;
 border: 2px solid white;
 padding: 8px 20px;
 border-radius: 8px;
 cursor: pointer;
 font-weight: 600;
 margin-top: 10px;
 transition: all 0.3s;
 }

 .btn-logout:hover {
 background: white;
 color: #43a047;
 }

 .menu-principal {
 display: grid;
 grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
 gap: 20px;
 margin-bottom: 30px;
 }

 .menu-card {
 background: white;
 padding: 25px;
 border-radius: 12px;
 box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
 text-align: center;
 cursor: pointer;
 transition: all 0.3s;
 border: 3px solid transparent;
 }

 .menu-card:hover {
 transform: translateY(-5px);
 box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
 border-color: #43a047;
 }

 .menu-card.active {
 border-color: #43a047;
 background: #f1f8e9;
 }

 .menu-card h3 {
 color: #43a047;
 margin-bottom: 10px;
 font-size: 1.3rem;
 }

 .menu-card p {
 color: #666;
 font-size: 0.9rem;
 }

 .seccion-contenido {
 display: none;
 background: white;
 padding: 25px;
 border-radius: 12px;
 box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
 }

 .seccion-contenido.active {
 display: block;
 animation: fadeIn 0.3s;
 }

 @keyframes fadeIn {
 from { opacity: 0; transform: translateY(10px); }
 to { opacity: 1; transform: translateY(0); }
 }

 .seccion-header {
 display: flex;
 justify-content: space-between;
 align-items: center;
 margin-bottom: 20px;
 padding-bottom: 15px;
 border-bottom: 2px solid #43a047;
 }

 .seccion-header h2 {
 color: #43a047;
 margin: 0;
 }

 .btn-volver {
 background: #e0e0e0;
 color: #333;
 padding: 8px 16px;
 border: none;
 border-radius: 6px;
 cursor: pointer;
 font-weight: 600;
 transition: all 0.2s;
 }

 .btn-volver:hover {
 background: #d0d0d0;
 }

 .lista-items {
 margin-top: 20px;
 }

 .item {
 background: #f5f5f5;
 padding: 15px;
 border-radius: 8px;
 margin-bottom: 10px;
 display: flex;
 justify-content: space-between;
 align-items: center;
 transition: all 0.2s;
 }

 .item:hover {
 background: #e8f5e9;
 transform: translateX(5px);
 }

 .item-info h4 {
 margin: 0 0 5px 0;
 color: #333;
 }

 .item-info p {
 margin: 0;
 color: #666;
 font-size: 0.9rem;
 }

 .item-acciones button {
 margin-left: 5px;
 }

 .sin-datos {
 text-align: center;
 padding: 40px;
 color: #999;
 }
 </style>
</head>
<body>

 <!-- TABS DE MODO - REDISE√ëADOS -->
 <div style="background: #2c3e50; padding: 0; box-shadow: 0 2px 10px rgba(0,0,0,0.2); margin-bottom: 0;">
 <div style="max-width: 1200px; margin: 0 auto; display: flex;">
 <button id="tabCoordinador" onclick="cambiarModo('coordinador')" 
 style="flex: 1; padding: 15px 30px; background: transparent; color: white; border: none; border-bottom: 4px solid white; cursor: pointer; font-size: 1.05rem; font-weight: 600; transition: all 0.3s; position: relative;"> Modo Coordinador
 </button>
 <button id="tabProfesor" onclick="cambiarModo('profesor')" 
 style="flex: 1; padding: 15px 30px; background: transparent; color: rgba(255,255,255,0.6); border: none; border-bottom: 4px solid transparent; cursor: pointer; font-size: 1.05rem; font-weight: 600; transition: all 0.3s; position: relative;">Modo Profesor
 </button>
 <button id="tabAcademia" onclick="irModoAcademia()" 
 style="display: none; flex: 1; padding: 15px 30px; background: transparent; color: rgba(255,255,255,0.6); border: none; border-bottom: 4px solid transparent; cursor: pointer; font-size: 1.05rem; font-weight: 600; transition: all 0.3s; position: relative;">Modo Academia
  </button>
 </div>
 </div>

 <!-- HEADER MAS COMPACTO -->
 <div id="headerCoordinador" style="background: linear-gradient(135deg, #888 0%, #666 100%); color: white; padding: 15px 20px; margin-bottom: 20px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 8px rgba(0,0,0,0.15); opacity: 0; transition: all 0.5s ease;">
 
 
<!-- Lado izquierdo: Titulo y selector de carrera -->
 <div style="flex: 0 0 auto;">
 
 <!-- Fila 1: Panel de Coordinador (solo) -->
 <div style="margin-bottom: 5px;">
 <span style="font-size: 0.85rem; color: rgba(255,255,255,0.85); font-weight: 500; text-transform: uppercase; letter-spacing: 0.5px;">Panel de Coordinador</span>
 </div>
 
 <!-- Fila 2: Nombre de la carrera (grande) -->
 <div id="carreraInfo" style="margin-bottom: 8px;">
 <h1 style="margin: 0; font-size: 2rem; font-weight: 800; color: white; text-shadow: 2px 2px 6px rgba(0,0,0,0.25); line-height: 1.2;">
 <span style="font-size: 0.75em; font-weight: 600; color: rgba(255,255,255,0.9);">Carrera:</span>
 <span id="carreraNombreDisplay">Cargando...</span>
 </h1>
 </div>
 
 <!-- Fila 3: Selector + Carreras asignadas -->
 <div style="display: flex; align-items: center; gap: 15px; flex-wrap: wrap;">
 <div id="selectorCarreras" style="display: none; align-items: center; gap: 8px;">
 <label style="font-weight: 500; color: rgba(255,255,255,0.85); font-size: 0.85rem;">Cambiar carrera:</label>
 <select id="selectCarrera" onchange="cambiarCarreraActiva()" 
 style="padding: 5px 10px; border: 2px solid white; border-radius: 6px; font-size: 0.85rem; font-weight: 600; background: white; color: #333; cursor: pointer; min-width: 180px;">
 <option value="">Cargando...</option>
 </select>
 </div>
 
 <span style="background: rgba(255,255,255,0.2); padding: 5px 10px; border-radius: 6px; font-size: 0.85rem; display: inline-block;">
 <strong>Carreras asignadas:</strong> <span id="cantidadCarreras">0</span>
 </span>
 </div>
 
 </div>
 
 <!-- Lado derecho: Info del usuario -->
 <div style="text-align: right;">
 <p style="margin: 3px 0; font-size: 0.9rem;"><strong>Nombre:</strong> <span id="nombreUsuario">Cargando...</span></p>
 <p style="margin: 3px 0; font-size: 0.9rem;"><strong>Email:</strong> <span id="emailUsuario">Cargando...</span></p>
 <p style="margin: 3px 0; font-size: 0.9rem;"><strong>Carrera:</strong> <span id="carreraUsuario">Cargando...</span></p>
 <p style="background: linear-gradient(135deg, #216A32 0%, #21596A 100%); color: white; padding: 5px 12px; border-radius: 6px; font-weight: 600; margin: 8px 0 8px auto; display: inline-block; font-size: 0.9rem;">
 <strong>Periodo:</strong> <span id="periodoUsuario">Cargando...</span>
 </p>
 <button onclick="cerrarSesion()" class="btn-logout" style="margin-top: 5px; padding: 6px 16px; font-size: 0.9rem;">Cerrar Sesion</button>
 </div>
 </div>

 <!-- CONTENEDOR MODO COORDINADOR -->
 <div id="modoCoordinador" style="display: block;">
 
 <!-- MENU PRINCIPAL -->
 <div id="menuPrincipal" class="menu-principal">
 <div class="menu-card" id="menuCarreras" onclick="mostrarSeccion('carreras')" style="display: none;">
 <h3>Carreras</h3>
 <p>Gestionar carreras y programas</p>
 </div>

 <div class="menu-card" onclick="mostrarSeccion('materias')">
 <h3>Materias</h3>
 <p>Crear y administrar materias</p>
 </div>

 <div class="menu-card" onclick="mostrarSeccion('profesores')">
 <h3>Gestionar Profesores</h3>
 <p>Crear y administrar profesores</p>
 </div>

 <div class="menu-card" onclick="mostrarSeccion('alumnos')">
 <h3>Gestionar Alumnos</h3>
 <p>Crear y administrar alumnos</p>
 </div>

 <div class="menu-card" onclick="mostrarSeccion('asignaciones')">
 <h3>Armar Grupos</h3>
 <p>Asignar profesores a materias</p>
 </div>

 <div class="menu-card" onclick="mostrarSeccion('inscripciones')">
 <h3>Inscripciones Especiales</h3>
 <p>Inscripciones fuera del grupo regular</p>
 </div>

 <div class="menu-card" onclick="mostrarSeccion('calificaciones')">
 <h3>Calificaciones</h3>
 <p>Ver y editar calificaciones</p>
 </div>

 <div class="menu-card" onclick="mostrarSeccion('periodos')">
 <h3>Periodos</h3>
 <p>Gestionar periodos academicos</p>
 </div>
 </div>

 <!-- SECCION: CARRERAS -->
 <div id="seccionCarreras" class="seccion-contenido">
 <div class="seccion-header">
 <h2>Gestion de Carreras</h2>
 <button onclick="volverMenu()" class="btn-volver">‚Üê Volver al Menu</button>
 </div>
 <div class="botones-accion">
 <button onclick="mostrarFormCarrera()" class="botAzu">Nueva Carrera</button>
 </div>
 <div id="listaCarreras" class="lista-items"></div>
 </div>

 <!-- SECCION: MATERIAS -->
 <div id="seccionMaterias" class="seccion-contenido">
 <div class="seccion-header">
 <h2>Gestion de Materias</h2>
 <button onclick="volverMenu()" class="btn-volver">‚Üê Volver al Menu</button>
 </div>
 
  <div class="botones-accion">
  <!--  <button onclick="mostrarFormMateria()" class="botAzu">Nueva Materia</button> -->
    <button onclick="mostrarModalMateriasMasivas()" class="botAzu" 
            style="background: linear-gradient(135deg, #ff9800 0%, #f57c00 100%);">
      Carga de Materias
    </button>
  </div>

 <div id="listaMaterias" class="lista-items"></div>
 </div>

 <!-- SECCION: GRUPOS -->
 <div id="seccionGrupos" class="seccion-contenido">
 <div class="seccion-header">
 <h2>Gestion de Grupos</h2>
 <button onclick="volverMenu()" class="btn-volver">‚Üê Volver al Menu</button>
 </div>
 <div class="botones-accion">
 <button onclick="mostrarGenerarGrupos()" class="botAzu">Generar Grupos</button>
 </div>
 <div id="listaGrupos" class="lista-items"></div>
 </div>

 <!-- SECCION: GESTIONAR PROFESORES -->
 <div id="seccionProfesores" class="seccion-contenido">
  <div class="seccion-header">
    <h2>Gestion de Profesores</h2>
    <button onclick="volverMenu()" class="btn-volver">Volver al Menu</button>
  </div>

  <div class="botones-accion">
    <button onclick="mostrarModalProfesoresMasivos()" class="botAzu" 
            style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
      Registro de Profesores
    </button>
  </div>

  <div id="listaProfesores" class="lista-items"></div>
</div>

 <!-- SECCION: GESTIONAR ALUMNOS -->
 <div id="seccionAlumnos" class="seccion-contenido">
 <div class="seccion-header">
 <h2>Registro de Alumnos</h2>
 <button onclick="volverMenu()" class="btn-volver">‚Üê Volver al Menu</button>
 </div>
 <div class="botones-accion">
 <button onclick="mostrarFormAlumno()" class="botAzu" style="background: linear-gradient(135deg, #007BFF 0%, #25C7EB 100%);">Nuevo Alumno</button>
 <!-- MODAL PARA REGISTRO MASIVO DE ALUMNOS -->
 
 <button onclick="mostrarFormRegistroMasivo()" class="botAzu" style="background: linear-gradient(135deg, #25C7EB 0%, #007BFF 100%);">
  Multiples Alumnos
</button>

 <button onclick="mostrarHistorialAlumnos()" class="botAzu" style="background: linear-gradient(135deg, #007BFF 20%, #FBFF00 80%);">
 Ver Historial
 </button>

<!-- Este c√≥digo se debe integrar en controlCoordinador.html -->

<!-- AGREGAR AL HTML-->



<!-- MODAL PARA REGISTRO MASIVO (agregar despu√©s del modalGenerico existente) -->
<div id="modalRegistroMasivo" class="modal" style="display: none;">
  <div class="modal-contenido" style="max-width: 900px;">
    <span class="cerrar" onclick="cerrarModalMasivo()">&times;</span>
    
    <h2 style="color: #667eea; margin-bottom: 10px;">Registro Masivo de Alumnos</h2>
    <p style="color: #666; margin-bottom: 20px;">Copia y pega desde Excel los datos de los alumnos</p>
    
    <form id="formRegistroMasivo" onsubmit="procesarRegistroMasivo(event)">
      
 

      <!-- INSTRUCCIONES -->
       <div style="background: #e3f2fd; border-left: 4px solid #2196f3; padding: 15px; border-radius: 4px; margin-bottom: 20px;">
        <strong style="color: #1565c0;">Instrucciones:</strong>
        <p style="margin: 10px 0 0 0; color: #333;">
          Abajo observar√°s 3 columnas: <strong>Nombre completo</strong>, <strong>Matr√≠cula</strong> y <strong>Correo</strong>.
          Coloca los datos en ese orden y con coherencia.
        </p>
        <p style="margin: 8px 0 0 0; color: #333;">
          Antes de darle a <strong>‚ÄúGuardar todos‚Äù</strong>, revisa los datos en la secci√≥n de <strong>‚ÄúVista previa‚Äù</strong> para asegurarte de que sean correctos.
        </p>
        <p style="margin: 8px 0 0 0; color: #333;">
          Se agreg√≥ un <strong>ejemplo</strong> para que puedas ver c√≥mo llenar los datos correctamente.
        </p>



      <!-- EJEMPLO VISUAL -->
        <br>
          <strong style="display: block; margin-bottom: 10px;">Ejemplo de formato esperado:</strong>
          <table style="width: 100%; border-collapse: collapse; font-size: 0.9rem;">
            <thead>
              <tr style="background: #667eea; color: white;">
                <th style="padding: 8px; border: 1px solid #ddd;">Nombre</th>
                <th style="padding: 8px; border: 1px solid #ddd;">Matricula</th>
                <th style="padding: 8px; border: 1px solid #ddd;">Email</th>
              </tr>
            </thead>
            <tbody>
              <tr style="background: white;">
                <td style="padding: 8px; border: 1px solid #ddd;">Ana Sofia Martinez Lopez</td>
                <td style="padding: 8px; border: 1px solid #ddd;">A20231045</td>
                <td style="padding: 8px; border: 1px solid #ddd;">ana.martinez@ilb.edu.mx</td>
              </tr>
              <tr style="background: #f9f9f9;">
                <td style="padding: 8px; border: 1px solid #ddd;">Luis Fernando Gomez Ruiz</td>
                <td style="padding: 8px; border: 1px solid #ddd;">A20231046</td>
                <td style="padding: 8px; border: 1px solid #ddd;">luis.gomez@ilb.edu.mx</td>
              </tr>
            </tbody>
          </table>
        

      </div>

    <!-- SELECTORES DE PERIODO, TURNO Y ORDEN -->
      <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
        
        <h4 style="margin: 0 0 15px 0; color: #333; font-size: 1.1rem;">Informaci√≥n del Grupo</h4>
        
        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px; margin-bottom: 15px;">
          
          <div class="form-grupo">
            <label for="periodoMasivo" style="font-weight: 600; color: #333; display: block; margin-bottom: 8px;">
              Periodo: *
            </label>
            <select id="periodoMasivo" required onchange="actualizarPreviewGrupoMasivo()"
                    style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 1rem; background: white;">
              <option value="">Seleccionar...</option>
            </select>
          </div>
          
          <div class="form-grupo">
            <label for="turnoMasivo" style="font-weight: 600; color: #333; display: block; margin-bottom: 8px;">
              Turno: *
            </label>
            <select id="turnoMasivo" required onchange="actualizarPreviewGrupoMasivo()"
                    style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 1rem; background: white;">
              <option value="">Seleccionar...</option>
              <option value="1">Matutino</option>
              <option value="2">Vespertino</option>
              <option value="3">Nocturno</option>
              <option value="4">Sabatino</option>
            </select>
          </div>

          <div class="form-grupo">
            <label for="ordenMasivo" style="font-weight: 600; color: #333; display: block; margin-bottom: 8px;">
              Orden: *
            </label>
            <input type="text" id="ordenMasivo" required value="01" maxlength="2" onchange="actualizarPreviewGrupoMasivo()"
                   style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 1rem;">
          </div>
        </div>

        <div style="background: #e3f2fd; padding: 15px; border-radius: 8px; border-left: 4px solid #1976d2; text-align: center;" id="previewGrupoMasivo">
          <em style="color: #999;">Selecciona periodo, turno y orden para ver el c√≥digo de grupo</em>
        </div>

        <small style="color: #666; display: block; margin-top: 15px; font-style: italic;">
          Todos los alumnos ser√°n asignados a este grupo
        </small>
      </div>


      <!-- CAMPOS PARA PEGAR DATOS -->
      <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px; margin-bottom: 20px;">
        
        <!-- NOMBRES -->
        <div>
          <label style="font-weight: 600; display: block; margin-bottom: 8px; color: #333;">
            Nombres Completos *
          </label>
          <textarea id="nombresMasivo" required rows="12" 
                    placeholder="Ana Sofia Martinez Lopez&#10;Luis Fernando Gomez Ruiz&#10;..."
                    style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 8px; font-family: monospace; font-size: 0.9rem; resize: vertical;"></textarea>
        </div>

        <!-- MATRICULAS -->
        <div>
          <label style="font-weight: 600; display: block; margin-bottom: 8px; color: #333;">
            Matriculas *
          </label>
          <textarea id="matriculasMasivo" required rows="12" 
                    placeholder="A20231045&#10;A20231046&#10;..."
                    style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 8px; font-family: monospace; font-size: 0.9rem; resize: vertical;"></textarea>
        </div>

        <!-- EMAILS -->
        <div>
          <label style="font-weight: 600; display: block; margin-bottom: 8px; color: #333;">
            Correos Electronicos *
          </label>
          <textarea id="emailsMasivo" required rows="12" 
                    placeholder="ana.martinez@ilb.edu.mx&#10;luis.gomez@ilb.edu.mx&#10;..."
                    style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 8px; font-family: monospace; font-size: 0.9rem; resize: vertical;"></textarea>
        </div>

      </div>

      <!-- AREA DE VISTA PREVIA -->
      <div id="vistaPrevia" style="display: none; background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 20px; max-height: 300px; overflow-y: auto;">
        <h3 style="margin-top: 0; color: #333; display: inline;">Vista Previa:</h3> <span style="color: #666;">Revisa que est√© correcto</span>

        <div id="contenidoVistaPrevia"></div>
      </div>

      <!-- BOTONES DE ACCION -->
      <div class="form-botones" style="display: flex; gap: 10px; justify-content: flex-end;">
        <button type="button" onclick="previsualizarDatos()" class="botAzu" 
                style="background: linear-gradient(135deg, #4caf50 0%, #2e7d32 100%);">
          Vista Previa
        </button>
        <button type="submit" class="botAzu" 
                style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
          Guardar Todos
        </button>
        <button type="button" onclick="cerrarModalMasivo()" class="botAzu" 
                style="background: #e0e0e0; color: #333;">
          Cancelar
        </button>
      </div>

    </form>

    <!-- BARRA DE PROGRESO -->
    <div id="barraProgreso" style="display: none; margin-top: 20px;">
      <div style="background: #e0e0e0; border-radius: 10px; height: 30px; overflow: hidden;">
        <div id="barraProgresoFill" 
             style="height: 100%; background: linear-gradient(90deg, #667eea 0%, #764ba2 100%); width: 0%; transition: width 0.3s; display: flex; align-items: center; justify-content: center; color: white; font-weight: 600; font-size: 0.9rem;">
          0%
        </div>
      </div>
      <p id="textoProgreso" style="text-align: center; margin-top: 10px; color: #666;">
        Procesando...
      </p>
    </div>

  </div>
</div>

<style>
/* Estilos adicionales para el modal masivo */
#modalRegistroMasivo .modal-contenido {
  max-height: 90vh;
  overflow-y: auto;
}

#modalRegistroMasivo textarea {
  font-family: 'Courier New', monospace;
  line-height: 1.5;
}

#modalRegistroMasivo textarea:focus {
  outline: none;
  border-color: #667eea;
  box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
}

.mensaje-exito-masivo {
  background: #d4edda;
  border: 2px solid #28a745;
  color: #155724;
  padding: 15px;
  border-radius: 8px;
  margin-bottom: 15px;
  font-weight: 600;
}

.mensaje-error-masivo {
  background: #f8d7da;
  border: 2px solid #dc3545;
  color: #721c24;
  padding: 15px;
  border-radius: 8px;
  margin-bottom: 15px;
  font-weight: 600;
}

.tabla-preview {
  width: 100%;
  border-collapse: collapse;
  font-size: 0.85rem;
}

.tabla-preview th {
  background: #667eea;
  color: white;
  padding: 8px;
  text-align: left;
  border: 1px solid #ddd;
}

.tabla-preview td {
  padding: 8px;
  border: 1px solid #ddd;
  background: white;
}

.tabla-preview tr:nth-child(even) td {
  background: #f9f9f9;
}

.error-row {
  background: #ffebee !important;
  color: #c62828;
}
</style>
 </div>
 
 <!-- FILTROS DE ALUMNOS -->
 <div id="panelFiltrosAlumnos" style="background: white; padding: 14px 18px; border-radius: 10px; margin-bottom: 15px; border: 1px solid #e0e0e0; box-shadow: 0 1px 4px rgba(0,0,0,0.06);">

   <!-- Fila 1: B√∫squeda (60%) + Estado -->
   <div style="display: flex; gap: 20px; align-items: flex-end; margin-bottom: 10px; flex-wrap: wrap;">
     <div style="flex: 0 0 58%;">
       <label style="font-weight: 600; font-size: 0.82rem; color: #555; display: block; margin-bottom: 5px;">üîç Buscar por nombre o matr√≠cula</label>
       <input type="text" id="filtroBusquedaAlumnos" oninput="aplicarFiltrosAlumnos()"
         placeholder="Escribir nombre o matr√≠cula..."
         style="width: 100%; padding: 7px 12px; border: 2px solid #ddd; border-radius: 7px; font-size: 0.9rem; box-sizing: border-box; transition: border-color 0.2s;"
         onfocus="this.style.borderColor='#43a047'" onblur="this.style.borderColor='#ddd'">
     </div>
     <div>
       <label style="font-weight: 600; font-size: 0.82rem; color: #555; display: block; margin-bottom: 5px;">Estado</label>
       <div style="display: flex; gap: 6px;">
         <button id="btnEstadoTodos"    onclick="setFiltroEstado('todos')"    class="filtro-btn filtro-btn-activo">Todos</button>
         <button id="btnEstadoActivo"   onclick="setFiltroEstado('activo')"   class="filtro-btn">Activo</button>
         <button id="btnEstadoInactivo" onclick="setFiltroEstado('inactivo')" class="filtro-btn">Inactivo</button>
         <button id="btnEstadoGraduado" onclick="setFiltroEstado('graduado')" class="filtro-btn">Graduado</button>
       </div>
     </div>
   </div>

   <!-- Fila 2: Tipo de alumno -->
   <div style="margin-bottom: 10px;">
     <label style="font-weight: 600; font-size: 0.82rem; color: #555; display: block; margin-bottom: 5px;">Tipo de alumno</label>
     <div style="display: flex; gap: 6px;">
       <button id="btnTipoTodos"    onclick="setFiltroTipo('todos')"    class="filtro-btn filtro-btn-activo">Todos</button>
       <button id="btnTipoRegular"  onclick="setFiltroTipo('regular')"  class="filtro-btn">Regular</button>
       <button id="btnTipoEspecial" onclick="setFiltroTipo('especial')" class="filtro-btn">Especial</button>
     </div>
   </div>

   <!-- Fila 3: Grupo (l√≠nea completa) -->
   <div style="margin-bottom: 4px;">
     <label style="font-weight: 600; font-size: 0.82rem; color: #555; display: block; margin-bottom: 5px;">Grupo</label>
     <div id="botonesGrupoAlumnos" style="display: flex; gap: 5px; flex-wrap: wrap;">
       <button id="btnGrupoTodos" onclick="setFiltroGrupo('todos')" class="filtro-btn filtro-btn-activo">Todos</button>
       <!-- se generan din√°micamente -->
     </div>
   </div>

   <!-- Contador -->
   <div style="margin-top: 8px; font-size: 0.82rem; color: #888;" id="contadorFiltroAlumnos"></div>
 </div>

 <style>
   .filtro-btn {
     padding: 5px 13px;
     border: 2px solid #ccc;
     border-radius: 20px;
     background: white;
     color: #555;
     cursor: pointer;
     font-size: 0.82rem;
     font-weight: 600;
     transition: all 0.18s;
     white-space: nowrap;
   }
   .filtro-btn:hover {
     border-color: #43a047;
     color: #43a047;
   }
   .filtro-btn-activo {
     background: #43a047 !important;
     border-color: #43a047 !important;
     color: white !important;
   }
 </style>
 
 <div id="listaAlumnos" class="lista-items"></div>
 </div>

 <!-- SECCION: ASIGNAR PROFESORES -->
 <div id="seccionAsignaciones" class="seccion-contenido">
  <div class="seccion-header">
    <h2>Asignar Materia y Profesor</h2>
    <button onclick="volverMenu()" class="btn-volver">‚Üê Volver al Menu</button>
  </div>
  
  <!-- Mensaje explicativo -->
  <div style="background: #e3f2fd; border-left: 4px solid #2196f3; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
    <strong style="color: #1565c0; font-size: 1rem;">Dos formas de asignar:</strong>
    <ul style="margin: 8px 0 0 0; color: #1565c0; font-size: 0.9rem; line-height: 1.6; padding-left: 20px;">
      <li><strong>Asignacion por materia:</strong> Selecciona una materia y asigna un profesor</li>
      <li><strong>Asignaciones por grupo:</strong> Selecciona un periodo y asigna profesores a todas las materias</li>
      <li><strong>Nota:</strong> El per√≠odo puede ser semestre, trimestre o cuatrimestre.</li>
    </ul>
  </div>
  
  <div class="botones-accion">
    <button onclick="mostrarFormAsignarProfesor()" class="botAzu">
      Asignacion por materia
    </button>
    <button onclick="mostrarFormAsignarProfesor2()" class="botAzu">
      Asignaciones por grupo
    </button>
  </div>

  <div id="listaAsignaciones" class="lista-items"></div>
</div>




 <!-- SECCION: INSCRIBIR ALUMNOS -->

  <!-- SECCION: INSCRIPCIONES ESPECIALES -->
  <div id="seccionInscripciones" class="seccion-contenido">
  <div class="seccion-header">
    <h2>Inscripciones Especiales</h2>
    <button onclick="volverMenu()" class="btn-volver">Volver al Menu</button>
  </div>
  
  <!-- Informacion explicativa -->
    <div style="background: #43a04857; padding: 10px 15px; border-radius: 8px; margin-bottom: 15px; border-left: 4px solid #2e7d32; color: #1b1b1b; font-size: 14px;">
      Alumnos que <strong>NO</strong> pertenecen a un grupo y tomar√°n materias de m√∫ltiples grupos.
    </div>


    
    <!-- Botones de accion -->
    <div class="botones-accion" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 25px;">
      <button onclick="mostrarFormCrearAlumnoEspecial()" 
              style="padding: 15px 20px; background: linear-gradient(135deg, #43a047 0%, #2e7d32 100%); color: white; border: none; border-radius: 10px; font-weight: 700; cursor: pointer; font-size: 1rem; box-shadow: 0 4px 12px rgba(67, 160, 71, 0.3);">
        + Crear Alumno Especial
      </button>
      
      <button onclick="mostrarFormInscribirAlumno()" 
              style="padding: 15px 20px; background: linear-gradient(135deg, #2196f3 0%, #1976d2 100%); color: white; border: none; border-radius: 10px; font-weight: 700; cursor: pointer; font-size: 1rem; box-shadow: 0 4px 12px rgba(33, 150, 243, 0.3);">
        Inscribir en Materia
      </button>
    </div>
    
    <!-- Lista de inscripciones -->
    <div id="listaInscripciones" class="lista-items">
      <div class="sin-datos">
        <p>Cargando inscripciones especiales...</p>
      </div>
    </div>
  </div>


 <!-- SECCION: CALIFICACIONES -->
 <div id="seccionCalificaciones" class="seccion-contenido">
 <div class="seccion-header">
 <h2>Gestionar Calificaciones</h2>
 <button onclick="volverMenu()" class="btn-volver">‚Üê Volver al Menu</button>
 </div>

 <div style="background: white; padding: 20px; border-radius: 10px; margin-bottom: 20px;">
 <h3 style="margin-top: 0;">Seleccionar Materia</h3>
 <div style="display: grid; gap: 15px;">
 <div>
 <label style="display: block; margin-bottom: 5px; font-weight: 600;">Materia:</label>
 <select id="selectMateriaCalif" onchange="cargarCalificacionesMateria()" 
 style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 5px;">
 <option value="">Seleccionar materia...</option>
 </select>
 <small style="color: #666; display: block; margin-top: 5px;">
 Selecciona una materia y grupo para ver y editar calificaciones
 </small>
 </div>
 </div>
 </div>

 <div id="contenedorCalificaciones" style="display: none;">
 <div style="background: white; padding: 20px; border-radius: 10px;">
 <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
 <div>
 <h3 style="margin: 0;" id="tituloMateriaCalif">Materia</h3>
 <p style="margin: 5px 0; color: #666;" id="infoMateriaCalif">Informacion de la materia</p>
 </div>
 <div style="display: flex; gap: 10px;">
 <button onclick="guardarTodasCalificacionesCoord()" 
 style="padding: 12px 24px; background: linear-gradient(135deg, #216A32 0%, #21596A 100%); color: white; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; font-size: 1rem;">
 Guardar Calificaciones
 </button>
 <button onclick="descargarActaPDF()" 
 style="padding: 12px 24px; background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; font-size: 1rem;">
 Descargar PDF
 </button>
 </div>
 </div>
 <div id="tablaCalificacionesCoord"></div>
 </div>
 </div>
 </div>

 <!-- SECCION: PERIODOS -->
<div id="seccionPeriodos" class="seccion-contenido">
  <div class="seccion-header">
    <h2>Periodos Academicos</h2>
    <button onclick="volverMenu()" class="btn-volver">‚Üê Volver al Menu</button>
  </div>

  <div style="background: white; padding: 20px; border-radius: 10px; margin-bottom: 20px;">
    <h3 style="margin-top: 0;">Informacion del Periodo Actual</h3>
    <div id="infoPeriodoActual" style="padding: 15px; background: #f8f9fa; border-radius: 8px;">
      <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
        <div>
          <div style="font-size: 0.85rem; color: #666; margin-bottom: 5px;">Periodo:</div>
          <div style="font-size: 1.8rem; font-weight: bold; color: #216A32;" id="periodoActualDisplay">2026-1</div>
          <!-- NUEVO: Mostrar tipo de periodo -->
          <div style="font-size: 0.9rem; color: #ff9800; font-weight: 600; margin-top: 5px;" id="tipoPeriodoDisplay">Cargando...</div>
        </div>
        <div>
          <div style="font-size: 0.85rem; color: #666; margin-bottom: 5px;">Alumnos Activos:</div>
          <div style="font-size: 1.8rem; font-weight: bold; color: #1976d2;" id="alumnosActivosDisplay">0</div>
        </div>
        <div>
          <div style="font-size: 0.85rem; color: #666; margin-bottom: 5px;">Grupos Activos:</div>
          <div style="font-size: 1.8rem; font-weight: bold; color: #f57c00;" id="gruposActivosDisplay">0</div>
        </div>
        <div>
          <div style="font-size: 0.85rem; color: #666; margin-bottom: 5px;">Asignaciones Activas:</div>
          <div style="font-size: 1.8rem; font-weight: bold; color: #7b1fa2;" id="asignacionesActivasDisplay">0</div>
        </div>
      </div>
    </div>
  </div>

  <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; margin-bottom: 20px;">
    <div style="background: white; padding: 20px; border-radius: 10px; border: 2px solid #667eea;">
      <h3 style="margin-top: 0; color: #667eea;">Cambiar Periodo</h3>
      <p style="color: #666; margin-bottom: 15px; font-size: 0.9rem;">Avanza tu carrera al siguiente periodo academico</p>
      <button onclick="mostrarCambioPeriodo(usuarioActual.carreraId, periodoActualCarrera)" 
        style="width: 100%; padding: 12px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; border-radius: 8px; font-weight: 600; cursor: pointer;">
        Cambiar Periodo
      </button>
    </div>

    <div style="background: white; padding: 20px; border-radius: 10px; border: 2px solid #4caf50;">
      <h3 style="margin-top: 0; color: #4caf50;">Historial de Grupos</h3>
      <p style="color: #666; margin-bottom: 15px; font-size: 0.9rem;">Ver grupos archivados de periodos anteriores</p>
      <button onclick="verHistorialGrupos(usuarioActual.carreraId)" 
        style="width: 100%; padding: 12px; background: linear-gradient(135deg, #4caf50 0%, #2e7d32 100%); color: white; border: none; border-radius: 8px; font-weight: 600; cursor: pointer;">
        Ver Historial
      </button>
    </div>
  </div>

  <div style="background: white; padding: 20px; border-radius: 10px;">
    <h3 style="margin-top: 0;">Informacion Importante</h3>
    <div style="background: #e8f5e9; border-left: 4px solid #4caf50; padding: 15px; border-radius: 4px; margin-bottom: 15px;">
      <strong>Que sucede al cambiar periodo:</strong>
      <ul style="margin: 10px 0; padding-left: 20px;">
        <li>Los alumnos avanzan al siguiente semestre (Ej: 1101-MAT a 1201-MAT)</li>
        <li>Los alumnos de ultimo semestre pasan a GRADUADOS</li>
        <li>Los grupos actuales se archivan en el historial</li>
        <li>Las asignaciones de profesores se desactivan</li>
        <li>Las calificaciones se guardan en el historial</li>
      </ul>
    </div>
    
    <div style="background: #fff3cd; border-left: 4px solid #ffc107; padding: 15px; border-radius: 4px; margin-bottom: 15px;">
      <strong>Importante:</strong>
      <p style="margin: 5px 0 0 0;">Esta accion solo afecta a tu carrera. Pero tus profesores y alumnos se veran afectados.</p>
    </div>
    
    <div style="background: #f8d7da; border-left: 4px solid #dc3545; padding: 15px; border-radius: 4px;">
      <strong>Advertencia:</strong>
      <p style="margin: 5px 0 0 0;">El cambio de periodo NO se puede deshacer. Asegurate de que todo este correcto antes de continuar.</p>
    </div>
  </div>
</div>

 <!-- MODAL GENERICO -->
 <div id="modalGenerico" class="modal">
 <div class="modal-contenido">
 <span class="cerrar" onclick="cerrarModal()">&times;</span>
 <h2 id="tituloModal">Formulario</h2>
 <div id="contenidoModal"></div>
 </div>
 </div>

 </div>
 <!-- FIN MODO COORDINADOR -->

 <!-- CONTENEDOR MODO PROFESOR -->
 <div id="modoProfesor" style="display: none;">
 <iframe id="iframeProfesor" src="" style="width: 100%; height: calc(100vh - 60px); border: none;"></iframe>
 </div>
 <!-- FIN MODO PROFESOR -->

 <!-- Firebase SDK -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.31/jspdf.plugin.autotable.min.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>


  <script src="../../js/utils/firebase.js"></script>


  <script src="../../js/utils/logoPdf.js"></script>
  <script src="../../js/coordinador/HistorialCoorPDF.js"></script>
  <script src="../../js/coordinador/HistorialAlumnoPDF.js"></script>
  <!-- ============================================= -->
  <!-- coordinador demaciado pesado ya -->
  <!-- <script src="coordinador.js"></script>  -->
  <!-- 1. CORE: Sistema central (auth, periodos, multi-carrera, navegaci√≥n) -->
  <!-- 2. UTILS: Utilidades y helpers (modales, validaciones, formateo) -->
  <!-- 3. MODULES: M√≥dulos de gesti√≥n (carreras, materias, grupos, profesores, alumnos, calificaciones) -->
  <!-- 4. COORDINADOR: Archivo principal de inicializaci√≥n y coordinaci√≥n -->
  <script src="../../js/coordinador/coordinaCore.js"></script>
  <script src="../../js/coordinador/coordinaUtils.js"></script>
  <script src="../../js/coordinador/coordinaModules.js"></script>
  <script src="../../js/coordinador/coordinadorN.js"></script>
  
  <script src="../../js/escolar/controlAlumnoEspecial.js"></script>  
  <script src="../../js/escolar/cambioPeriodo.js"></script>
  <script src="../../js/escolar/registroMasivoAlumno.js"></script>
  <script src="../../js/escolar/registroMasivoMaterias.js"></script>
  <script src="../../js/escolar/registroMasivoProfes.js"></script>


  <!-- Script para habilitar Modo Academia si el coordinador tiene academia -->
  <script>
    // Funci√≥n para ir a modo academia
    function irModoAcademia() {
      window.location.href = './controlAcademia.html';
    }
    
    // Verificar y mostrar bot√≥n de academia despu√©s de que cargue el usuario
    function verificarYMostrarAcademia() {
      if (typeof usuarioActual !== 'undefined' && usuarioActual) {
        const tieneAcademiaUnica = usuarioActual.tieneAcademia && usuarioActual.academiaId;
        const tieneAcademias = usuarioActual.academias && usuarioActual.academias.length > 0;
        
        if (tieneAcademiaUnica || tieneAcademias) {
          const btnAcademia = document.getElementById('tabAcademia');
          if (btnAcademia) {
            btnAcademia.style.display = 'flex';
            console.log('Modo Academia habilitado');
          }
        }
      }
    }
    
    // Ejecutar verificaci√≥n cuando el usuario est√© cargado
    // Se ejecutar√° m√∫ltiples veces para asegurar que se muestre
    const intervalVerificar = setInterval(() => {
      if (typeof usuarioActual !== 'undefined' && usuarioActual) {
        verificarYMostrarAcademia();
        clearInterval(intervalVerificar);
      }
    }, 500);
    
    // Timeout de seguridad (dejar de intentar despu√©s de 10 segundos)
    setTimeout(() => {
      clearInterval(intervalVerificar);
    }, 10000);
  </script>
  <script>
 window.addEventListener('load', () => {
 if (typeof window.jspdf !== 'undefined') {
 console.log('jsPDF cargado correctamente');
 } else {
 console.error('ERROR: jsPDF no se cargo');
 }
 });
 </script>

</body>
</html>